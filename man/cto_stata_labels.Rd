% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cto_stata_labels.R
\name{cto_stata_labels}
\alias{cto_stata_labels}
\title{Generate Stata Variable and Value Labels from SurveyCTO Form Definitions}
\usage{
cto_stata_labels(req, form_id, export = NULL, overwrite = TRUE)
}
\arguments{
\item{req}{A \code{httr2_request} object initialized via
\code{\link{cto_request}()}.}

\item{form_id}{Character string. The unique ID of the SurveyCTO form.}

\item{export}{Character (optional). The file path where the resulting \code{.do}
file should be saved. Must end in \code{.do}.}

\item{overwrite}{Logical. Whether to overwrite the file if it already
exists at the \code{export} path. Defaults to \code{TRUE}.}
}
\value{
A character vector containing the lines of the generated Stata \code{.do}
file, returned invisibly.
}
\description{
This function automates the creation of a Stata \code{.do} file that applies
variable labels, value labels, and notes to a dataset. It parses the
XLSForm structure from SurveyCTO, handles multi-language forms, and
accounts for complex structures like repeat groups and select-multiple fields.
}
\details{
The function performs several cleaning and transformation steps:
\itemize{
\item \strong{Language Detection:} Automatically selects the default
language labels or falls back to English if no default is specified.
\item \strong{Value Labels:} Creates Stata \verb{label define} commands for
all \code{select_one} and \code{select_multiple} choice lists.
\item \strong{Regex Mapping:} For variables inside repeat groups, the
function generates Stata-compatible regex patterns to ensure labels
are applied to all indexed versions (e.g., \code{var_1}, \code{var_2}).
\item \strong{Label Cleaning:} Removes HTML tags, escapes special Stata
characters, and handles dynamic SurveyCTO string interpolation (e.g., \verb{$\{var\}}).
}
}
\examples{
\dontrun{
# Authenticate and generate labels
req <- cto_request("my_server", "username", "password")
cto_stata_labels(req, "household_survey", export = "labels.do")
}
}
\author{
Gutama Girja Urago
}
